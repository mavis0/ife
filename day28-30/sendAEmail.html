<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">    
        <title>IFE ECMAScript</title>
    </head>
    <body>
        <div class="wrapper">
            <input id="email-input" type="text">
            <ul id="email-sug-wrapper" class="email-sug"></ul>
        </div>
    </body>
</html>
<script>
    // keydown --> keypress --> input --> keyup(for most keys)
    var postfixList = ['163.com', 'gmail.com', '126.com', 'qq.com', '263.net'];
    var input = document.getElementById('email-input');var input = document.getElementById('email-input');
    var option = document.getElementById('email-sug-wrapper');
    // input.addEventListener('keydown', event => {
    //     console.log('keydown handle');
    // })
    // input.addEventListener('keyup', event => {
    //     console.log('keyup handle');
    // })
    // input.addEventListener('keypress', event => {
    //     console.log('keypress handle');
    // })
    // input.addEventListener('input', event => {
    //     console.log('input handle');
    // })
    input.addEventListener('input', monitor);
    function monitor() {
        clearOptions();
        generateOption();
        optionsVisible();
    }
    function clearOptions(){
        option.innerHTML = '';
    }
    function optionsVisible(){
        if (getUserInput() === ''){
            option.style.display = 'none';
        } else {
            option.style.display = 'block';
        }
    }
    function generateOption(){
        var prefix = getUserInput();
        var afterAt = '';
        if (prefix.indexOf('@') != -1) {
            afterAt = prefix.substring(prefix.indexOf('@') + 1);
            console.log(afterAt);
            prefix = prefix.substring(0, prefix.indexOf('@'));
        }
        postfixList.forEach(i => {
            var item = document.createElement('li');
            if (i.startsWith(afterAt)) {
                item.innerHTML = prefix + '@' + i;
                option.appendChild(item);
            }
        })
    }
    function getUserInput() {
        return input.value.trim();
    }
</script>
<style>
    li:hover {
        background-color: skyblue;
    }
</style>